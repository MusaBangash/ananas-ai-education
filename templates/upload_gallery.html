{% extends "base.html" %}

{% block content %}
<!-- Header Section -->
<div class="dashboard-header py-4 bg-gradient position-relative mb-4">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-8">
                <h1 class="text-white mb-2" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.3)">Upload to Gallery</h1>
                <p class="text-white mb-0" style="text-shadow: 1px 1px 3px rgba(0,0,0,0.2)">
                    Share images with your community
                </p>
            </div>
        </div>
    </div>
    <div class="custom-shape-divider-bottom">
        <svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120" preserveAspectRatio="none">
            <path d="M321.39,56.44c58-10.79,114.16-30.13,172-41.86,82.39-16.72,168.19-17.73,250.45-.39C823.78,31,906.67,72,985.66,92.83c70.05,18.48,146.53,26.09,214.34,3V0H0V27.35A600.21,600.21,0,0,0,321.39,56.44Z" class="shape-fill"></path>
        </svg>
    </div>
</div>

<div class="container pb-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card border-0 shadow-sm hover-lift">
                <div class="card-body p-4">
                    <form method="POST" enctype="multipart/form-data" class="needs-validation" novalidate>
                        <!-- Title Input -->
                        <div class="mb-4">
                            <label for="title" class="form-label fw-bold">
                                <i class="fas fa-heading me-2 text-primary"></i>Title
                            </label>
                            <input type="text" 
                                   class="form-control form-control-lg" 
                                   id="title" 
                                   name="title" 
                                   required
                                   placeholder="Enter image title">
                            <div class="invalid-feedback">Please provide a title for the image.</div>
                        </div>
                        
                        <!-- Category Select -->
                        <div class="mb-4">
                            <label for="category" class="form-label fw-bold">
                                <i class="fas fa-tag me-2 text-primary"></i>Category
                            </label>
                            <select class="form-select form-select-lg" 
                                    id="category" 
                                    name="category" 
                                    required>
                                <option value="" selected disabled>Select a category</option>
                                <option value="General">General</option>
                                <option value="Education">Education</option>
                                <option value="Tour">Tour</option>
                                <option value="Quiz">Quiz</option>
                                <option value="Information">Information</option>
                                <option value="Facts">Facts</option>
                            </select>
                            <div class="invalid-feedback">Please select a category.</div>
                        </div>

                        <!-- Description Textarea -->
                        <div class="mb-4">
                            <label for="description" class="form-label fw-bold">
                                <i class="fas fa-align-left me-2 text-primary"></i>Description
                            </label>
                            <textarea class="form-control" 
                                      id="description" 
                                      name="description" 
                                      rows="4"
                                      placeholder="Provide a brief description of the image"></textarea>
                        </div>

                        <!-- Image Upload -->
                        <div class="mb-4">
                            <label for="image" class="form-label fw-bold">
                                <i class="fas fa-image me-2 text-primary"></i>Image
                            </label>
                            <div class="image-upload-container">
                                <input type="file" 
                                       class="form-control form-control-lg" 
                                       id="image" 
                                       name="image" 
                                       required
                                       accept="image/*"
                                       onchange="previewImage(this);">
                                <div class="invalid-feedback">Please select an image to upload.</div>
                                <div id="imagePreview" class="mt-3 text-center d-none">
                                    <img src="" alt="Preview" class="img-fluid rounded" style="max-height: 300px;">
                                </div>
                            </div>
                            <small class="text-muted mt-2">
                                Supported formats: JPG, PNG, GIF
                            </small>
                        </div>

                        <!-- Action Buttons -->
                        <div class="d-flex justify-content-end gap-2 mt-4">
                            <a href="{{ url_for('gallery') }}" class="btn btn-light btn-lg px-4">
                                <i class="fas fa-times me-2"></i>Cancel
                            </a>
                            <button type="submit" class="btn btn-primary btn-lg px-4">
                                <i class="fas fa-cloud-upload-alt me-2"></i>Upload Image
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Image Preview Script -->
<script>
function previewImage(input) {
    const preview = document.getElementById('imagePreview');
    const previewImg = preview.querySelector('img');
    
    if (input.files && input.files[0]) {
        const reader = new FileReader();
        
        reader.onload = function(e) {
            previewImg.src = e.target.result;
            preview.classList.remove('d-none');
        }
        
        reader.readAsDataURL(input.files[0]);
    }
}

// Form validation
(function () {
    'use strict'
    var forms = document.querySelectorAll('.needs-validation')
    Array.prototype.slice.call(forms).forEach(function (form) {
        form.addEventListener('submit', function (event) {
            if (!form.checkValidity()) {
                event.preventDefault()
                event.stopPropagation()
            }
            form.classList.add('was-validated')
        }, false)
    })
})()
</script>
{% endblock %}